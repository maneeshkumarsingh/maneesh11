import osimport pandas as pdfrom config import TrainingData, Add_TrainingData, Time_intervalfrom config import host_name,db_name,db_user,db_psswdimport globimport reimport loggingimport mysql.connectorimport timeimport datetimefrom datetime import timedeltawhile True:    try:        mydb = mysql.connector.connect(host=host_name, database=db_name, user=db_user,                                       passwd=db_psswd, use_pure=True, port= 3306)        print("DB Connection successful")        query = """               SELECT LABEL,UD FROM ML_TRAIN_DATA WHERE LABEL IN ('A2P','P2P') and                UNIX_TIMESTAMP(CREATE_TIME) > UNIX_TIMESTAMP() - %(duration)s*60*60            """        # Duration will be in  hour        data = pd.read_sql(query,mydb, params ={"duration": Time_interval })        columns = ['lable', 'text']        #Read data which in we want to add        Added_data = pd.read_csv(Add_TrainingData, names= columns)        # Giving same name for both table db table and adding  data table        data.columns = Added_data.columns        # adding new data in adding table and drop dublect and keep latest one        Added_data = Added_data.append(data, ignore_index = True)        Added_data = Added_data.drop_duplicates(subset=['text'], keep='last')        Added_data.to_csv(Add_TrainingData, index = None, header=False)        print('Done')        mydb.close()    except Exception as e:        print("DB Connection unsuccessful")        break    time.sleep(Time_interval*60*60)    #time.sleep(60)